import{_ as pe,o as me,x as ge,c as v,a as u,b as t,e as o,w as a,r as c,q as he,g as p,E as m,i as r,F as N,h as L,n as fe,f as I,k as ye,t as d,p as we}from"./index-yPDpAw82.js";import{k as b}from"./knowledge-CVyRSNEl.js";const Ce={class:"knowledge-center-container"},ke={class:"page-header"},be={class:"header-content"},Ve={class:"header-icon"},ze={class:"header-actions"},Fe={class:"content-section"},Ke={class:"category-sidebar"},Se={class:"category-list"},xe=["onClick"],Ae={class:"category-icon"},De={class:"category-info"},Re={class:"knowledge-content"},Ue={class:"content-header"},Ee={class:"breadcrumb"},Ne={class:"view-options"},Le={key:0,class:"loading-container"},Ie={key:1,class:"empty-container"},Me={key:2},$e={key:0,class:"knowledge-grid"},je={class:"card-image"},Be=["src","alt"],He={class:"card-content"},Te={class:"card-category"},Ge={class:"card-title"},qe={class:"card-summary"},Pe={class:"card-meta"},Qe={class:"meta-item"},Je={class:"meta-item"},Oe={class:"meta-item"},We={key:1,class:"knowledge-list"},Xe={class:"list-content"},Ye={class:"list-image"},Ze=["src","alt"],et={class:"list-info"},tt={class:"list-category"},ot={class:"list-title"},st={class:"list-summary"},at={class:"list-meta"},lt={class:"meta-item"},nt={class:"meta-item"},it={class:"meta-item"},ct={class:"pagination-container"},dt={key:0,class:"knowledge-detail"},rt={class:"detail-header"},ut={class:"detail-category"},_t={class:"detail-title"},vt={class:"detail-meta"},pt={class:"meta-item"},mt={class:"meta-item"},gt={class:"meta-item"},ht={class:"detail-content"},ft=["innerHTML"],yt={class:"detail-actions"},wt={__name:"KnowledgeCenter",setup(Ct){const q=ge(),F=p(""),f=p("all"),K=p("grid"),C=p(!1),g=p(1),k=p(12),V=p(0),y=p([]),S=p(!1),_=p(null),z=p([{id:"all",name:"全部",count:0,icon:"Grid",color:"#409EFF"},{id:"慢性病管理",name:"慢性病管理",count:0,icon:"FirstAid",color:"#F56C6C"},{id:"饮食营养",name:"饮食营养",count:0,icon:"Food",color:"#67C23A"},{id:"心理健康",name:"心理健康",count:0,icon:"ChatDotRound",color:"#909399"},{id:"运动健身",name:"运动健身",count:0,icon:"TrendCharts",color:"#E6A23C"},{id:"老年健康",name:"老年健康",count:0,icon:"Clock",color:"#606266"},{id:"儿童健康",name:"儿童健康",count:0,icon:"User",color:"#409EFF"}]),P=()=>{const l=z.value.find(e=>e.id===f.value);return l?l.name:"全部"},Q=()=>{const l={};for(const e of y.value)l[e.category]=(l[e.category]||0)+1;z.value=z.value.map(e=>e.id==="all"?{...e,count:V.value}:{...e,count:l[e.id]||0})},J=l=>{f.value=l,g.value=1,h()},O=()=>{g.value=1,h()},h=async()=>{var l,e;C.value=!0;try{const n=await b.getArticles({page:g.value,page_size:k.value,category:f.value==="all"?void 0:f.value,keyword:F.value||void 0,sort_by:"latest"});y.value=n.items||[],V.value=n.total||0,Q()}catch(n){m.error(((e=(l=n==null?void 0:n.response)==null?void 0:l.data)==null?void 0:e.detail)||"加载知识内容失败")}finally{C.value=!1}},x=async l=>{var e,n;try{const i=await b.getArticleDetail(l.id);_.value=i,S.value=!0,await h()}catch(i){m.error(((n=(e=i==null?void 0:i.response)==null?void 0:e.data)==null?void 0:n.detail)||"加载详情失败")}},M=async()=>{var l,e;if(_.value)try{await b.favoriteArticle(_.value.id),_.value.favorite_count+=1,m.success("已收藏"),await h()}catch(n){m.error(((e=(l=n==null?void 0:n.response)==null?void 0:l.data)==null?void 0:e.detail)||"收藏失败")}},W=async()=>{var l,e;C.value=!0;try{const n=await b.getFavorites({page:1,page_size:k.value});y.value=n.items||[],V.value=n.total||0,f.value="all",m.success("已切换到我的收藏")}catch(n){m.error(((e=(l=n==null?void 0:n.response)==null?void 0:l.data)==null?void 0:e.detail)||"加载收藏失败")}finally{C.value=!1}},X=async()=>{var l,e;try{const n=await b.getReadHistory(30);if(!n.length){m.info("暂无阅读记录");return}const i=n.slice(0,6).map(D=>`《${D.article_title}》`).join("、");m.info(`最近阅读：${i}`)}catch(n){m.error(((e=(l=n==null?void 0:n.response)==null?void 0:l.data)==null?void 0:e.detail)||"加载阅读记录失败")}},Y=()=>{m.info("分享功能开发中...")},Z=()=>{M()},ee=l=>{k.value=l,g.value=1,h()},te=l=>{g.value=l,h()},A=l=>l?new Date(l).toLocaleDateString("zh-CN"):"-";return me(()=>{h().then(async()=>{const l=Number(q.query.article);l&&await x({id:l})})}),(l,e)=>{var T;const n=c("Reading"),i=c("el-icon"),D=c("Search"),oe=c("el-input"),w=c("el-button"),$=c("el-col"),j=c("ArrowRight"),se=c("Grid"),B=c("el-radio-button"),ae=c("List"),le=c("el-radio-group"),ne=c("el-skeleton"),ie=c("el-empty"),R=c("View"),U=c("Star"),E=c("Clock"),H=c("el-card"),ce=c("el-pagination"),de=c("el-row"),re=c("User"),ue=c("Share"),_e=c("Collection"),ve=c("el-dialog");return u(),v("div",Ce,[t("div",ke,[t("div",be,[t("div",Ve,[o(i,{size:"32",color:"#409EFF"},{default:a(()=>[o(n)]),_:1})]),e[5]||(e[5]=t("div",{class:"header-text"},[t("h1",null,"健康知识中心"),t("p",null,"获取专业的健康知识和养生指导")],-1))]),t("div",ze,[o(oe,{modelValue:F.value,"onUpdate:modelValue":e[0]||(e[0]=s=>F.value=s),placeholder:"搜索健康知识...",class:"search-input",onKeyup:he(O,["enter"])},{prefix:a(()=>[o(i,null,{default:a(()=>[o(D)]),_:1})]),_:1},8,["modelValue"]),o(w,{class:"header-btn",onClick:W},{default:a(()=>[...e[6]||(e[6]=[r("我的收藏",-1)])]),_:1}),o(w,{class:"header-btn",onClick:X},{default:a(()=>[...e[7]||(e[7]=[r("阅读记录",-1)])]),_:1})])]),t("div",Fe,[o(de,{gutter:24},{default:a(()=>[o($,{span:6},{default:a(()=>[t("div",Ke,[e[8]||(e[8]=t("div",{class:"sidebar-header"},[t("h3",null,"知识分类")],-1)),t("div",Se,[(u(!0),v(N,null,L(z.value,s=>(u(),v("div",{key:s.id,class:fe(["category-item",{active:f.value===s.id}]),onClick:G=>J(s.id)},[t("div",Ae,[o(i,{size:"20",color:s.color},{default:a(()=>[(u(),I(ye(s.icon)))]),_:2},1032,["color"])]),t("div",De,[t("h4",null,d(s.name),1),t("p",null,d(s.count)+" 篇文章",1)])],10,xe))),128))])])]),_:1}),o($,{span:18},{default:a(()=>[t("div",Re,[t("div",Ue,[t("div",Ee,[e[9]||(e[9]=t("span",null,"首页",-1)),o(i,null,{default:a(()=>[o(j)]),_:1}),e[10]||(e[10]=t("span",null,"知识中心",-1)),o(i,null,{default:a(()=>[o(j)]),_:1}),t("span",null,d(P()),1)]),t("div",Ne,[o(le,{modelValue:K.value,"onUpdate:modelValue":e[1]||(e[1]=s=>K.value=s),size:"small"},{default:a(()=>[o(B,{label:"grid"},{default:a(()=>[o(i,null,{default:a(()=>[o(se)]),_:1})]),_:1}),o(B,{label:"list"},{default:a(()=>[o(i,null,{default:a(()=>[o(ae)]),_:1})]),_:1})]),_:1},8,["modelValue"])])]),C.value?(u(),v("div",Le,[o(ne,{rows:3,animated:""})])):y.value.length===0?(u(),v("div",Ie,[o(ie,{description:"暂无相关知识内容"},{default:a(()=>[o(w,{type:"primary"},{default:a(()=>[...e[11]||(e[11]=[r("推荐内容",-1)])]),_:1})]),_:1})])):(u(),v("div",Me,[K.value==="grid"?(u(),v("div",$e,[(u(!0),v(N,null,L(y.value,s=>(u(),I(H,{key:s.id,class:"knowledge-card",shadow:"hover",onClick:G=>x(s)},{default:a(()=>[t("div",je,[t("img",{src:s.cover_image||"/default-health.jpg",alt:s.title},null,8,Be)]),t("div",He,[t("div",Te,d(s.category),1),t("h3",Ge,d(s.title),1),t("p",qe,d(s.summary),1),t("div",Pe,[t("span",Qe,[o(i,null,{default:a(()=>[o(R)]),_:1}),r(" "+d(s.view_count),1)]),t("span",Je,[o(i,null,{default:a(()=>[o(U)]),_:1}),r(" "+d(s.favorite_count),1)]),t("span",Oe,[o(i,null,{default:a(()=>[o(E)]),_:1}),r(" "+d(A(s.created_at)),1)])])])]),_:2},1032,["onClick"]))),128))])):(u(),v("div",We,[(u(!0),v(N,null,L(y.value,s=>(u(),I(H,{key:s.id,class:"knowledge-list-item",shadow:"hover",onClick:G=>x(s)},{default:a(()=>[t("div",Xe,[t("div",Ye,[t("img",{src:s.cover_image||"/default-health.jpg",alt:s.title},null,8,Ze)]),t("div",et,[t("div",tt,d(s.category),1),t("h3",ot,d(s.title),1),t("p",st,d(s.summary),1),t("div",at,[t("span",lt,[o(i,null,{default:a(()=>[o(R)]),_:1}),r(" "+d(s.view_count),1)]),t("span",nt,[o(i,null,{default:a(()=>[o(U)]),_:1}),r(" "+d(s.favorite_count),1)]),t("span",it,[o(i,null,{default:a(()=>[o(E)]),_:1}),r(" "+d(A(s.created_at)),1)])])])])]),_:2},1032,["onClick"]))),128))])),t("div",ct,[o(ce,{"current-page":g.value,"onUpdate:currentPage":e[2]||(e[2]=s=>g.value=s),"page-size":k.value,"onUpdate:pageSize":e[3]||(e[3]=s=>k.value=s),"page-sizes":[12,24,48],total:V.value,layout:"total, sizes, prev, pager, next, jumper",onSizeChange:ee,onCurrentChange:te},null,8,["current-page","page-size","total"])])]))])]),_:1})]),_:1})]),o(ve,{modelValue:S.value,"onUpdate:modelValue":e[4]||(e[4]=s=>S.value=s),title:(T=_.value)==null?void 0:T.title,width:"80%",class:"knowledge-detail-dialog"},{default:a(()=>[_.value?(u(),v("div",dt,[t("div",rt,[t("div",ut,d(_.value.category),1),t("h2",_t,d(_.value.title),1),t("div",vt,[t("span",pt,[o(i,null,{default:a(()=>[o(re)]),_:1}),e[12]||(e[12]=r(" 健康科普 ",-1))]),t("span",mt,[o(i,null,{default:a(()=>[o(E)]),_:1}),r(" "+d(A(_.value.created_at)),1)]),t("span",gt,[o(i,null,{default:a(()=>[o(R)]),_:1}),r(" "+d(_.value.view_count)+" 阅读 ",1)])])]),t("div",ht,[t("div",{class:"content-text",innerHTML:_.value.content},null,8,ft)]),t("div",yt,[o(w,{type:"primary",onClick:M},{default:a(()=>[o(i,null,{default:a(()=>[o(U)]),_:1}),r(" 收藏 ("+d(_.value.favorite_count)+") ",1)]),_:1}),o(w,{onClick:Y},{default:a(()=>[o(i,null,{default:a(()=>[o(ue)]),_:1}),e[13]||(e[13]=r(" 分享 ",-1))]),_:1}),o(w,{onClick:Z},{default:a(()=>[o(i,null,{default:a(()=>[o(_e)]),_:1}),e[14]||(e[14]=r(" 收藏 ",-1))]),_:1})])])):we("",!0)]),_:1},8,["modelValue","title"])])}}},Vt=pe(wt,[["__scopeId","data-v-cb07476a"]]);export{Vt as default};
